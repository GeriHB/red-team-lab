# Monitoring an Environment

**Regular `nmap` diffing:**

A script that is created to email us daily diffs of the `nmap` results. [nmap_diffing.sh](Tools/nmap_diffing.sh).

**Web Screenshot:**

Monitors for different web applications.
Tools to use: 
- HTTPScreenshot - Uses `masscan` to scan network and `phantomjs` to take screencaptures of any website found.
- EyeWitness - takes an `xml` file from `nmap` output and screenshots webpages, RDP servers, and VNC Servers.

**Cloud Scanning:**

Many users of the cloud have dynamic IPs, so it's hard to have a specific IP address, as it depends on many factors, which for an outsider makes it hard to find them.

**Shodan:**

It regularly scans the internet, grabs banners, ports, information about network, and more. 

**Censys.io:**

Continuously monitors every reachable server and device on the internet. It also scrapes information from SSL certificates, so this can be used to find where the victim's servers are located on cloud servers.

A script tool to query Censys: [https://github.com/christophetd/censys-subdomain-finder](Censys Subdomain Finder).

**Manually Parsing SSL Certificates**

Many companies don't have ACLs properly implemented, but many databases, Jenkin servers, Tomcat management, etc are publicly facing.

A tool to use is `sslScrape` which uses `Masscan`, identifies services on port 443, and then strips the hostname in the certificates. [https://github.com/cheetz/sslScrape](sslScrape).

**Discover Scripts:**

This tool combines all the recon tools on Kali Linux and utilizes the following tools: `dnsrecon`, `goofile`, `goog-mail`, `goohost`, `theHarvester`, `Metasploit`, `URLCrazy`, `Whois`, `recon-ng`, etc.

[https://github.com/leebaird/discover](Discover).

A good part of this tool is that it keeps searching based on the information it finds.

**KNOCK** - Subdomain brute-force through a wordlist. 

**Sublist3r**: KNOCK uses wordlists, meaning that some companies have unique subdomains that can't be found. *Sublist3r* uses different *google dorks*, meaning that can be temporarily blacklisted. 

**SubBrute:** Uses open resolvers as a kind of proxy to circumvent DNS rate-limiting, and it does not send traffic directly to the target's name servers, and it performs a DNS spider feature to crawl enumerated DNS records.

**Truggle Hog:** scans Github commit histories and branches for high entropy keys, and prints them. This helps to find secrets, passwords, keys, and more.

## Cloud

Most common issues are:
- Amazon S3 Missing Buckets.
- Amazon S3 Bucket Permissions.
- Being able to list and write files to public AWS buckets.
- Lack of logging.

**slurp:** Is a tool that helps to enumerate, applying multiple permutation from a list, and tries to identify different buckets.

**Bucket Finder:** not only attempts to find but also downloads all the content from these buckets.

**tko-subs:** Utilizes the subdomain takeover vulnerability, which means that some companies use third party CMS/Content/Cloud Provider and point their subdomains to these platforms, then when they don't need it they forget the CNAME redirect. So, now attackers can set it up and have valid bucket on victim's domain. *tko-subs* checks whether any of the subdomains found can be taken over.

## Emails

**SimplyEmail:** Provides email addresses format of a company and a list of valid users.

